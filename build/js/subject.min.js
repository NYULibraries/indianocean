/*! indianocean-site 2018-09-18 */
YUI().use("node","event","io","handlebars","json-parse","jsonp","paginator","jsonp-url","router","querystring-parse","gallery-paginator",function(a){"use strict";function b(a){for(var b=0;b<r.length;b++)if(r[b].tid==a)return r[b]}function c(){a.log("onFailure")}function d(){c()}function e(b){a.log(b),this.setPage(b.page,!0),this.setRowsPerPage(b.rowsPerPage,!0),p.save(p.getPath()+"?page="+b.page)}function f(b,c,d){var f={totalRecords:c,rowsPerPage:d,initialPage:b,template:"{FirstPageLink} {PageLinks} {NextPageLink}"},g=new a.Paginator(f);g.on("changeRequest",e),g.render("#paginator")}function g(b,c){try{var d=c.container,e=a.one(".resultsnum"),g=c.page?c.page:1,h=parseInt(b.response.numFound,10),j=e.one(".numfound"),l=parseInt(b.response.start,10),n=1>l?1:l,p=e.one(".start"),q=e.one(".docslength"),r=parseInt(b.response.docs.length,10);m.length<1&&f(g,h,r),m.push(this.url),b.response.docs.forEach(function(a,c){b.response.docs[c].appRoot=k,b.response.docs[c].identifier=a.ss_identifer,b.response.docs[c].app=a.ss_collection_identifier}),d.setAttribute("data-numFound",h),d.setAttribute("data-start",l),d.setAttribute("data-docsLength",r),p.set("innerHTML",n),q.set("innerHTML",l+r),j.set("innerHTML",h),d.append(o({items:b.response.docs})),i.removeClass("io-loading")}catch(s){a.log("something went wrong. error")}}function h(b){var e=10,f=0,h=0,j="ss_longlabel",k="asc",l="en",m="http://discovery.dlib.nyu.edu:8080/solr3_discovery/viewer/select",n=["ss_embedded","title","type","ss_collection_identifier","ss_identifer","ss_representative_image","teaser","sm_field_title","ss_language","sm_field_publication_date_text","sm_field_publication_location","sm_field_publisher","sm_vid_Terms","tm_vid_1_names","sm_partners","sm_ar_title","sm_ar_author","sm_ar_publisher","sm_ar_publication_location","sm_ar_subjects","sm_ar_publication_date","sm_ar_partners","sm_field_title","sm_author","sm_publisher","ss_pubdate","sm_subject","sm_partners"];b.page&&(h=parseInt(b.page,10)),b.language&&(l=b.language),b.start&&(f=parseInt(b.start,10)),b.rows&&(e=parseInt(b.rows,10));var o=m+"?wt=json&json.wrf=callback={callback}&fq=hash:705lna&fq=ss_collection_identifier:d72398c3-1cd7-4734-ab1c-3e3b29862cee&fq=ss_language:"+l+"&fl="+n.join()+"&rows="+e+"&start="+f+"&sort="+j+"%20"+k;b.fq&&(o=o+"&fq="+b.fq.join("&fq=")),i.addClass("io-loading"),b.container.empty(),a.jsonp(o,{on:{success:g,failure:c,timeout:d},args:b,timeout:3e3})}var i=a.one("body"),j=a.QueryString.parse(location.search,"?"),k=(a.one('[data-name="subjects"]'),i.getAttribute("data-app")),l=i.getAttribute("data-approot"),m=[],n=a.one("#hbs_items").getHTML(),o=a.Handlebars.compile(n),p=new a.Router,q=a.one("#subjecsList"),r=JSON.parse(q.get("innerHTML"));a.Handlebars.registerHelper("subject",function(a){var c=b(a);return c?'<a href="'+l+"/subject?tid="+c.tid+'">'+c.term+"</a>":void 0}),p.route(l+"/subject/",function(c){var d=c.query.rows?c.query.rows:10,e=c.query.page?parseInt(c.query.page,10):0,f=0,g=c.query.tid,i=b(g),j=a.one('[data-name="subjects"]'),k=a.one(".subjectname");k.set("innerHTML",i.term),f=1>=e?0:e*d-d,h({container:j,start:f,fq:["im_field_subject:"+i.tid],page:e,rows:d})});var s="";j.tid&&(s=j.tid),j.page&&(ruta=ruta+"&page="+j.page),p.save(p.getPath()+"?tid="+s)});